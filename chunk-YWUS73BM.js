import{b as E,c as N,e as A,h as R}from"./chunk-QU2R5EOE.js";import{$a as F,Aa as g,Ea as h,Ha as b,J as C,N as T,O as x,Qa as l,Ra as r,Sa as s,Ta as c,Xa as U,Ya as M,Z as d,bb as p,cb as u,hb as O,ib as P,ta as S,ua as $,va as a}from"./chunk-T354MRBQ.js";function H(t){let e=new Date(t),n=(new Date().getTime()-e.getTime())/1e3,o={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};for(let v in o){let m=Math.floor(n/o[v]);if(m>=1)return`${m} ${v}${m>1?"s":""} ago`}return"just now"}function Y(t){let e=typeof t=="string"?parseInt(t):t;return e>=1e9?(e/1e9).toFixed(1).replace(/\.0$/,"")+"B views":e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M views":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K views":e+" views"}function k(t,e){let i=e[0];return{videoDetails:{contentDetails:{duration:t.contentDetails.duration},statistics:{viewCount:t.statistics.viewCount,commentCount:t.statistics.commentCount,likeCount:t.statistics.likeCount},snippet:{thumbnails:t.snippet.thumbnails,channelId:t.snippet.channelId,title:t.snippet.title,channelTitle:t.snippet.channelTitle,publishedAt:t.snippet.publishedAt,description:t.snippet.description},id:t.id},channelId:i.id,channelProfilePic:i.snippet.thumbnails.default?.url??""}}function K(t){let e=t.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/),i=parseInt(e?.[1]||"0",10),n=parseInt(e?.[2]||"0",10),o=parseInt(e?.[3]||"0",10);return i>0?`${i}:${n.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${n}:${o.toString().padStart(2,"0")}`}var V={production:!1,apiKey:"AIzaSyDWsKhi_G5QGsBNKcCpXmf7ARoU19ues2M",videosUrl:"https://www.googleapis.com/youtube/v3",channelUrl:"https://www.googleapis.com/youtube/v3/channels"};var f=class t{constructor(e){this.http=e}apiKey=V.apiKey;apiUrl=V.videosUrl;channelUrl=V.channelUrl;getVideos(e){return this.http.get(`${this.apiUrl}/videos?key=${this.apiKey}`,{params:e})}getChannel(e){return this.http.get(`${this.channelUrl}?key=${this.apiKey}&id=${e}&part=snippet`)}static \u0275fac=function(i){return new(i||t)(T(A))};static \u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})};function G(t,e){if(t&1&&(r(0,"div",13),c(1,"img",14),r(2,"p"),p(3),s()()),t&2){let i,n=e.ngIf,o=M();F("opacity",o.previewVisible()?0:1)("transition","opacity 0.28s ease"),a(),l("src",n,S)("alt",(i=o.finalVideo().videoDetails.snippet)==null?null:i.title),a(2),u(o.formatYouTubeDuration(o.finalVideo().videoDetails.contentDetails.duration))}}function B(t,e){if(t&1&&(r(0,"div",15),c(1,"iframe",16),s()),t&2){let i=e.ngIf;a(),l("src",i,$)}}var _=class t{constructor(e){this.youtubeService=e}video=P();channel=d([]);finalVideo=d(void 0);previewVisible=d(!1);iframeSrc=d(null);timerId;sanitizer=x(R);formatViews=Y;timeAgo=H;ngOnInit(){let e=this.video();e?.snippet.channelId&&this.youtubeService.getChannel(e.snippet.channelId).subscribe(i=>{this.channel.set(i.items),this.finalVideo.set(k(this.video(),this.channel()))})}showPreview(){this.timerId=setTimeout(()=>{let e=this.finalVideo()?.videoDetails?.id;if(!e)return;let i=new URLSearchParams({autoplay:"1",mute:"1",controls:"0",rel:"0",modestbranding:"1",playsinline:"1",loop:"1",playlist:e}),n=`https://www.youtube.com/embed/${e}?${i.toString()}`;this.iframeSrc.set(this.sanitizer.bypassSecurityTrustResourceUrl(n)),this.previewVisible.set(!0),console.log(e)},300)}hidePreview(){this.previewVisible.set(!1),this.iframeSrc.set(null),clearTimeout(this.timerId)}formatYouTubeDuration=K;static \u0275fac=function(i){return new(i||t)(g(f))};static \u0275cmp=h({type:t,selectors:[["app-video-card"]],inputs:{video:[1,"video"]},decls:19,vars:7,consts:[[1,"video","card",3,"mouseenter","mouseleave"],[1,"video-media"],["class","video-img",3,"opacity","transition",4,"ngIf"],["class","video-preview",4,"ngIf"],[1,"video-info"],[1,"left-side"],["alt","Channel pfp",3,"src"],[1,"center"],[1,"video-title"],[1,"channel-title"],[1,"video-more-info"],[1,"video-views"],[1,"video-date"],[1,"video-img"],[3,"src","alt"],[1,"video-preview"],["width","100%","height","100%","frameborder","0","allow","autoplay; encrypted-media; picture-in-picture","allowfullscreen","",3,"src"]],template:function(i,n){if(i&1&&(r(0,"div",0),U("mouseenter",function(){return n.showPreview()})("mouseleave",function(){return n.hidePreview()}),r(1,"div",1),b(2,G,4,7,"div",2)(3,B,2,1,"div",3),s(),r(4,"div",4)(5,"div",5),c(6,"img",6),s(),r(7,"div",7)(8,"div",8),p(9),s(),r(10,"div",9),p(11),s(),r(12,"div",10)(13,"p",11),p(14),s(),r(15,"span"),p(16,"\u2022"),s(),r(17,"p",12),p(18),s()()()()()),i&2){let o,v,m,w,I,D;a(2),l("ngIf",(o=n.finalVideo())==null||o.videoDetails==null||o.videoDetails.snippet==null||o.videoDetails.snippet.thumbnails==null||o.videoDetails.snippet.thumbnails.maxres==null?null:o.videoDetails.snippet.thumbnails.maxres.url),a(),l("ngIf",n.iframeSrc()),a(3),l("src",(v=n.finalVideo())==null?null:v.channelProfilePic,S),a(3),u((m=n.finalVideo())==null?null:m.videoDetails.snippet.title),a(2),u((w=n.finalVideo())==null?null:w.videoDetails.snippet.channelTitle),a(3),u(n.formatViews((I=n.finalVideo())==null?null:I.videoDetails.statistics.viewCount)),a(4),u(n.timeAgo((D=n.finalVideo())==null?null:D.videoDetails.snippet.publishedAt))}},dependencies:[N],encapsulation:2})};function L(t,e){if(t&1&&c(0,"app-video-card",2),t&2){let i=e.$implicit;l("video",i)}}var y=class t{constructor(e){this.youtubeService=e;O(()=>{console.log(this.videos())})}videos=d([]);ngOnInit(){let e={part:"snippet,statistics,contentDetails",chart:"mostPopular",regionCode:"EG",maxResults:10};this.youtubeService.getVideos(e).subscribe(i=>this.videos.set(i.items))}static \u0275fac=function(i){return new(i||t)(g(f))};static \u0275cmp=h({type:t,selectors:[["app-home"]],decls:2,vars:1,consts:[[1,"app-container"],[3,"video",4,"ngFor","ngForOf"],[3,"video"]],template:function(i,n){i&1&&(r(0,"div",0),b(1,L,1,1,"app-video-card",1),s()),i&2&&(a(),l("ngForOf",n.videos()))},dependencies:[_,E],encapsulation:2})};var he=[{path:"",component:y}];export{he as HOME_ROUTES};
