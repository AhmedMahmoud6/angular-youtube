import{b as J}from"./chunk-QPWPZNES.js";import{a as K}from"./chunk-4F5CCLGC.js";import{$ as p,Aa as Y,Ba as z,D as d,F as E,Ga as Q,Ha as D,K as S,L as T,Ma as Z,N as r,O as M,P as V,Qa as j,S as f,U as N,Ua as y,Va as $,Wa as q,Xa as B,Y as s,Ya as G,Z as l,_ as a,da as O,ea as R,ga as k,ia as P,ja as u,ma as W,na as H,oa as U,pa as A,qa as F,ta as c,ua as g,v,w as _,x as b,xa as L}from"./chunk-WGU3TOID.js";function te(t,i){if(t&1&&(l(0,"div",15),p(1,"img",16),l(2,"p"),c(3),a()()),t&2){let e,n=i.ngIf,o=u(2);F("opacity",o.previewVisible()?0:1)("transition","opacity 0.28s ease"),r(),s("src",n,S)("alt",(e=o.finalVideo().videoDetails.snippet)==null?null:e.title),r(2),g(o.formatYouTubeDuration(o.finalVideo().videoDetails.contentDetails.duration))}}function ne(t,i){if(t&1&&(l(0,"div",15),p(1,"img",16),a()),t&2){let e,n,o=u(2);r(),s("src",(e=o.finalVideo())==null||e.videoDetails==null||e.videoDetails.snippet==null||e.videoDetails.snippet.thumbnails==null||e.videoDetails.snippet.thumbnails.high==null?null:e.videoDetails.snippet.thumbnails.high.url,S)("alt",(n=o.finalVideo())==null||n.videoDetails==null||n.videoDetails.snippet==null?null:n.videoDetails.snippet.title)}}function oe(t,i){if(t&1&&(l(0,"div",17),p(1,"iframe",18),a()),t&2){let e=i.ngIf;r(),s("src",e,T)}}function le(t,i){if(t&1){let e=k();l(0,"div",2),P("mouseenter",function(){_(e);let o=u();return b(o.showPreview())})("mouseleave",function(){_(e);let o=u();return b(o.hidePreview())})("click",function(){let o;_(e);let h=u();return b(h.onClick((o=h.finalVideo())==null||o.videoDetails==null||o.videoDetails.snippet==null?null:o.videoDetails.snippet.categoryId))}),l(1,"div",3),f(2,te,4,7,"div",4)(3,ne,2,2,"ng-template",null,0,L)(5,oe,2,1,"div",5),a(),l(6,"div",6)(7,"div",7),p(8,"img",8),a(),l(9,"div",9)(10,"div",10),c(11),a(),l(12,"div",11),c(13),a(),l(14,"div",12)(15,"p",13),c(16),a(),l(17,"span"),c(18,"\u2022"),a(),l(19,"p",14),c(20),a()()()()()}if(t&2){let e,n,o,h,w,C,X=A(4),m=u();r(2),s("ngIf",(e=m.finalVideo())==null||e.videoDetails==null||e.videoDetails.snippet==null||e.videoDetails.snippet.thumbnails==null||e.videoDetails.snippet.thumbnails.maxres==null?null:e.videoDetails.snippet.thumbnails.maxres.url)("ngIfElse",X),r(3),s("ngIf",m.iframeSrc()),r(3),s("src",(n=m.finalVideo())==null?null:n.channelProfilePic,S),r(3),g((o=m.finalVideo())==null?null:o.videoDetails.snippet.title),r(2),g((h=m.finalVideo())==null?null:h.videoDetails.snippet.channelTitle),r(3),g(m.formatViews((w=m.finalVideo())==null?null:w.videoDetails.statistics.viewCount)),r(4),g(m.timeAgo((C=m.finalVideo())==null?null:C.videoDetails.snippet.publishedAt))}}var I=class t{constructor(i){this.youtubeService=i}video=z();channel=d([]);finalVideo=d(void 0);router=v(j);previewVisible=d(!1);iframeSrc=d(null);timerId;sanitizer=v(Z);formatViews=q;timeAgo=$;formatYouTubeDuration=G;ngOnInit(){let i=this.video();i?.snippet.channelId&&this.youtubeService.getChannel(i.snippet.channelId).subscribe(e=>{this.channel.set(e.items),this.finalVideo.set(B(this.video(),this.channel()));let n=this.finalVideo()?.videoDetails.snippet.categoryId})}showPreview(){this.timerId=setTimeout(()=>{let i=this.finalVideo()?.videoDetails?.id;if(!i)return;let e=new URLSearchParams({autoplay:"1",mute:"1",controls:"0",rel:"0",modestbranding:"1",playsinline:"1",loop:"1",playlist:i}),n=`https://www.youtube.com/embed/${i}?${e.toString()}`;this.iframeSrc.set(this.sanitizer.bypassSecurityTrustResourceUrl(n)),this.previewVisible.set(!0)},300)}hidePreview(){this.previewVisible.set(!1),this.iframeSrc.set(null),clearTimeout(this.timerId)}onClick(i){this.youtubeService.homeVideoCategoryId?.set(i),this.youtubeService.isVideoFromHome.set(!0),this.router.navigate(["/video",this.finalVideo().videoDetails.id])}static \u0275fac=function(e){return new(e||t)(M(y))};static \u0275cmp=V({type:t,selectors:[["app-video-card"]],inputs:{video:[1,"video"]},decls:1,vars:1,consts:[["fallbackImg",""],["class","video card ",3,"mouseenter","mouseleave","click",4,"ngIf"],[1,"video","card",3,"mouseenter","mouseleave","click"],[1,"video-media"],["class","video-img",3,"opacity","transition",4,"ngIf","ngIfElse"],["class","video-preview",4,"ngIf"],[1,"video-info"],[1,"left-side"],["alt","Channel pfp",3,"src"],[1,"center"],[1,"video-title"],[1,"channel-title"],[1,"video-more-info"],[1,"video-views"],[1,"video-date"],[1,"video-img"],[3,"src","alt"],[1,"video-preview"],["width","100%","height","100%","frameborder","0","allow","autoplay; encrypted-media; picture-in-picture","allowfullscreen","",3,"src"]],template:function(e,n){e&1&&f(0,le,21,8,"div",1),e&2&&s("ngIf",n.finalVideo())},dependencies:[D],encapsulation:2})};var re=["sentinel"];function ae(t,i){if(t&1&&p(0,"app-video-card",5),t&2){let e=i.$implicit;s("video",e)}}function se(t,i){t&1&&(O(0),l(1,"div",6),p(2,"mat-progress-spinner",7),a(),R())}var x=class t{youtubeService=v(y);ngZone=v(N);videos=d([]);nextPageToken=d(void 0);isLoading=d(!1);error=d(null);homeSetupDone=d(!1);homeSentinel;sharedObserver=J(this.ngZone,{root:null,rootMargin:"300px",threshold:1});set homeSectionRef(i){let e=this.videos();this.homeSentinel=i.nativeElement??void 0,!this.homeSetupDone()&&this.homeSentinel&&e&&(this.homeSetupDone.set(!0),this.sharedObserver?.observeElement(this.homeSentinel,{isLoading:this.isLoading,nextPageToken:this.nextPageToken,youtubeService:this.youtubeService,loadWhat:"videos",error:this.error,videos:this.videos}))}ngAfterViewInit(){}ngOnDestroy(){this.sharedObserver?.unobserveElement(this.homeSentinel),this.sharedObserver?.disconnect()}constructor(){Y(()=>{})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=V({type:t,selectors:[["app-home"]],viewQuery:function(e,n){if(e&1&&W(re,5,E),e&2){let o;H(o=U())&&(n.homeSectionRef=o.first)}},decls:5,vars:2,consts:[["sentinel",""],[1,"app-container"],[3,"video",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"sentinel"],[3,"video"],[1,"loading-spinner"],["mode","indeterminate","diameter","50","strokeWidth","4"]],template:function(e,n){e&1&&(l(0,"div",1),f(1,ae,1,1,"app-video-card",2),a(),f(2,se,3,0,"ng-container",3),p(3,"div",4,0)),e&2&&(r(),s("ngForOf",n.videos()),r(),s("ngIf",n.isLoading()))},dependencies:[I,Q,K,D],encapsulation:2})};var Fe=[{path:"",component:x}];export{Fe as HOME_ROUTES};
