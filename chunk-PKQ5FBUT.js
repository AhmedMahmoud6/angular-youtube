import{c as G}from"./chunk-M5T5LS73.js";import{a as J}from"./chunk-BF7W5C4N.js";import{$ as u,Ba as Y,D as d,F as O,Ga as z,Ha as I,K as S,L as M,Ma as Q,N as l,O as N,P as V,Qa as Z,S as f,U as R,Ua as w,Va as j,Wa as $,Xa as q,Y as s,Ya as B,Z as r,_ as a,da as y,ea as D,ga as k,ia as P,ja as c,ma as H,na as L,oa as A,pa as W,qa as F,ta as m,ua as g,v,w as _,x as b,xa as U}from"./chunk-ARSTZJ72.js";function ie(i,t){if(i&1&&(r(0,"div",15),u(1,"img",16),r(2,"p"),m(3),a()()),i&2){let e,n=t.ngIf,o=c(2);F("opacity",o.previewVisible()?0:1)("transition","opacity 0.28s ease"),l(),s("src",n,S)("alt",(e=o.finalVideo().videoDetails.snippet)==null?null:e.title),l(2),g(o.formatYouTubeDuration(o.finalVideo().videoDetails.contentDetails.duration))}}function te(i,t){if(i&1&&(r(0,"div",15),u(1,"img",16),a()),i&2){let e,n,o=c(2);l(),s("src",(e=o.finalVideo())==null||e.videoDetails==null||e.videoDetails.snippet==null||e.videoDetails.snippet.thumbnails==null||e.videoDetails.snippet.thumbnails.high==null?null:e.videoDetails.snippet.thumbnails.high.url,S)("alt",(n=o.finalVideo())==null||n.videoDetails==null||n.videoDetails.snippet==null?null:n.videoDetails.snippet.title)}}function ne(i,t){if(i&1&&(r(0,"div",17),u(1,"iframe",18),a()),i&2){let e=t.ngIf;l(),s("src",e,M)}}function oe(i,t){if(i&1){let e=k();r(0,"div",2),P("mouseenter",function(){_(e);let o=c();return b(o.showPreview())})("mouseleave",function(){_(e);let o=c();return b(o.hidePreview())})("click",function(){let o;_(e);let h=c();return b(h.onClick((o=h.finalVideo())==null||o.videoDetails==null||o.videoDetails.snippet==null?null:o.videoDetails.snippet.categoryId))}),r(1,"div",3),f(2,ie,4,7,"div",4)(3,te,2,2,"ng-template",null,0,U)(5,ne,2,1,"div",5),a(),r(6,"div",6)(7,"div",7),u(8,"img",8),a(),r(9,"div",9)(10,"div",10),m(11),a(),r(12,"div",11),m(13),a(),r(14,"div",12)(15,"p",13),m(16),a(),r(17,"span"),m(18,"\u2022"),a(),r(19,"p",14),m(20),a()()()()()}if(i&2){let e,n,o,h,E,T,K=W(4),p=c();l(2),s("ngIf",(e=p.finalVideo())==null||e.videoDetails==null||e.videoDetails.snippet==null||e.videoDetails.snippet.thumbnails==null||e.videoDetails.snippet.thumbnails.maxres==null?null:e.videoDetails.snippet.thumbnails.maxres.url)("ngIfElse",K),l(3),s("ngIf",p.iframeSrc()),l(3),s("src",(n=p.finalVideo())==null?null:n.channelProfilePic,S),l(3),g((o=p.finalVideo())==null?null:o.videoDetails.snippet.title),l(2),g((h=p.finalVideo())==null?null:h.videoDetails.snippet.channelTitle),l(3),g(p.formatViews((E=p.finalVideo())==null?null:E.videoDetails.statistics.viewCount)),l(4),g(p.timeAgo((T=p.finalVideo())==null?null:T.videoDetails.snippet.publishedAt))}}var x=class i{constructor(t){this.youtubeService=t}video=Y();channel=d([]);finalVideo=d(void 0);router=v(Z);previewVisible=d(!1);iframeSrc=d(null);timerId;sanitizer=v(Q);formatViews=$;timeAgo=j;formatYouTubeDuration=B;ngOnInit(){let t=this.video();t?.snippet.channelId&&this.youtubeService.getChannel(t.snippet.channelId).subscribe(e=>{this.channel.set(e.items),this.finalVideo.set(q(this.video(),this.channel()));let n=this.finalVideo()?.videoDetails.snippet.categoryId})}showPreview(){this.timerId=setTimeout(()=>{let t=this.finalVideo()?.videoDetails?.id;if(!t)return;let e=new URLSearchParams({autoplay:"1",mute:"1",controls:"0",rel:"0",modestbranding:"1",playsinline:"1",loop:"1",playlist:t}),n=`https://www.youtube.com/embed/${t}?${e.toString()}`;this.iframeSrc.set(this.sanitizer.bypassSecurityTrustResourceUrl(n)),this.previewVisible.set(!0)},300)}hidePreview(){this.previewVisible.set(!1),this.iframeSrc.set(null),clearTimeout(this.timerId)}onClick(t){this.youtubeService.homeVideoCategoryId?.set(t),this.youtubeService.isVideoFromHome.set(!0),this.router.navigate(["/video",this.finalVideo().videoDetails.id])}static \u0275fac=function(e){return new(e||i)(N(w))};static \u0275cmp=V({type:i,selectors:[["app-video-card"]],inputs:{video:[1,"video"]},decls:1,vars:1,consts:[["fallbackImg",""],["class","video card ",3,"mouseenter","mouseleave","click",4,"ngIf"],[1,"video","card",3,"mouseenter","mouseleave","click"],[1,"video-media"],["class","video-img",3,"opacity","transition",4,"ngIf","ngIfElse"],["class","video-preview",4,"ngIf"],[1,"video-info"],[1,"left-side"],["alt","Channel pfp",3,"src"],[1,"center"],[1,"video-title"],[1,"channel-title"],[1,"video-more-info"],[1,"video-views"],[1,"video-date"],[1,"video-img"],[3,"src","alt"],[1,"video-preview"],["width","100%","height","100%","frameborder","0","allow","autoplay; encrypted-media; picture-in-picture","allowfullscreen","",3,"src"]],template:function(e,n){e&1&&f(0,oe,21,8,"div",1),e&2&&s("ngIf",n.finalVideo())},dependencies:[I],encapsulation:2})};var le=["sentinel"];function re(i,t){if(i&1&&u(0,"app-video-card",5),i&2){let e=t.$implicit;s("video",e)}}function ae(i,t){i&1&&(y(0),r(1,"div",6),u(2,"mat-progress-spinner",7),a(),D())}function se(i,t){i&1&&u(0,"div",8,0)}function de(i,t){i&1&&(y(0),r(1,"h1",9),m(2,"Failed To Load Videos"),a(),D())}function me(i,t){i&1&&(y(0),r(1,"h1",9),m(2,"You're Offline, Check your Internet And Try Again"),a(),D())}var C=class i{youtubeService=v(w);ngZone=v(R);isOnline=d(window.navigator.onLine);videos=d([]);nextPageToken=d(void 0);isLoading=d(!1);error=d(null);homeSetupDone=d(!1);homeSentinel;sharedObserver=G(this.ngZone,{root:null,rootMargin:"300px",threshold:1});set homeSectionRef(t){let e=this.videos();this.homeSentinel=t.nativeElement??void 0,!this.homeSetupDone()&&this.homeSentinel&&e&&(this.homeSetupDone.set(!0),this.sharedObserver?.observeElement(this.homeSentinel,{isLoading:this.isLoading,nextPageToken:this.nextPageToken,youtubeService:this.youtubeService,loadWhat:"videos",error:this.error,videos:this.videos}))}ngAfterViewInit(){}ngOnDestroy(){this.sharedObserver?.unobserveElement(this.homeSentinel),this.sharedObserver?.disconnect()}constructor(){window.addEventListener("online",()=>{this.isOnline.set(!0)}),window.addEventListener("offline",()=>{this.isOnline.set(!1)})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=V({type:i,selectors:[["app-home"]],viewQuery:function(e,n){if(e&1&&H(le,5,O),e&2){let o;L(o=A())&&(n.homeSectionRef=o.first)}},decls:6,vars:5,consts:[["sentinel",""],[1,"app-container"],[3,"video",4,"ngFor","ngForOf"],[4,"ngIf"],["class","sentinel",4,"ngIf"],[3,"video"],[1,"loading-spinner"],["mode","indeterminate","diameter","50","strokeWidth","4"],[1,"sentinel"],[1,"error-h1"]],template:function(e,n){e&1&&(r(0,"div",1),f(1,re,1,1,"app-video-card",2),a(),f(2,ae,3,0,"ng-container",3)(3,se,2,0,"div",4)(4,de,3,0,"ng-container",3)(5,me,3,0,"ng-container",3)),e&2&&(l(),s("ngForOf",n.videos()),l(),s("ngIf",n.isLoading()),l(),s("ngIf",n.isOnline()),l(),s("ngIf",n.error()),l(),s("ngIf",!n.isOnline()))},dependencies:[x,z,J,I],encapsulation:2})};var ze=[{path:"",component:C}];export{ze as HOME_ROUTES};
