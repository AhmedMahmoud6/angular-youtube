import{b as N,c as P,e as A,h as R}from"./chunk-QU2R5EOE.js";import{$a as O,Aa as g,Ea as h,Ha as b,J as D,N as U,O as x,Qa as l,Ra as r,Sa as a,Ta as m,Xa as F,Ya as M,Z as d,bb as c,cb as f,hb as $,ib as E,ta as w,ua as T,va as s}from"./chunk-T354MRBQ.js";function H(i){let e=new Date(i),n=(new Date().getTime()-e.getTime())/1e3,o={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};for(let v in o){let p=Math.floor(n/o[v]);if(p>=1)return`${p} ${v}${p>1?"s":""} ago`}return"just now"}function k(i){let e=typeof i=="string"?parseInt(i):i;return e>=1e9?(e/1e9).toFixed(1).replace(/\.0$/,"")+"B views":e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M views":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K views":e+" views"}function K(i,e){let t=e[0];return{videoDetails:{statistics:{viewCount:i.statistics.viewCount,commentCount:i.statistics.commentCount,likeCount:i.statistics.likeCount},snippet:{thumbnails:i.snippet.thumbnails,channelId:i.snippet.channelId,title:i.snippet.title,channelTitle:i.snippet.channelTitle,publishedAt:i.snippet.publishedAt,description:i.snippet.description},id:i.id},channelId:t.id,channelProfilePic:t.snippet.thumbnails.default?.url??""}}var _={production:!1,apiKey:"AIzaSyDWsKhi_G5QGsBNKcCpXmf7ARoU19ues2M",videosUrl:"https://www.googleapis.com/youtube/v3",channelUrl:"https://www.googleapis.com/youtube/v3/channels"};var u=class i{constructor(e){this.http=e}apiKey=_.apiKey;apiUrl=_.videosUrl;channelUrl=_.channelUrl;getVideos(e){return this.http.get(`${this.apiUrl}/videos?key=${this.apiKey}`,{params:e})}getChannel(e){return this.http.get(`${this.channelUrl}?key=${this.apiKey}&id=${e}&part=snippet`)}static \u0275fac=function(t){return new(t||i)(U(A))};static \u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"})};function W(i,e){if(i&1&&(r(0,"div",13),m(1,"img",14),a()),i&2){let t,n=e.ngIf,o=M();O("opacity",o.previewVisible()?0:1)("transition","opacity 0.28s ease"),s(),l("src",n,w)("alt",(t=o.finalVideo().videoDetails.snippet)==null?null:t.title)}}function G(i,e){if(i&1&&(r(0,"div",15),m(1,"iframe",16),a()),i&2){let t=e.ngIf;s(),l("src",t,T)}}var V=class i{constructor(e){this.youtubeService=e}video=E();channel=d([]);finalVideo=d(void 0);previewVisible=d(!1);iframeSrc=d(null);sanitizer=x(R);formatViews=k;timeAgo=H;ngOnInit(){let e=this.video();e?.snippet.channelId&&this.youtubeService.getChannel(e.snippet.channelId).subscribe(t=>{this.channel.set(t.items),this.finalVideo.set(K(this.video(),this.channel()))})}showPreview(){let e=this.finalVideo()?.videoDetails?.id;if(!e)return;let t=new URLSearchParams({autoplay:"1",mute:"1",controls:"0",rel:"0",modestbranding:"1",playsinline:"1",loop:"1",playlist:e}),n=`https://www.youtube.com/embed/${e}?${t.toString()}`;this.iframeSrc.set(this.sanitizer.bypassSecurityTrustResourceUrl(n)),this.previewVisible.set(!0),console.log(e)}hidePreview(){this.previewVisible.set(!1),this.iframeSrc.set(null)}static \u0275fac=function(t){return new(t||i)(g(u))};static \u0275cmp=h({type:i,selectors:[["app-video-card"]],inputs:{video:[1,"video"]},decls:19,vars:7,consts:[[1,"video","card",3,"mouseenter","mouseleave"],[1,"video-media"],["class","video-img",3,"opacity","transition",4,"ngIf"],["class","video-preview",4,"ngIf"],[1,"video-info"],[1,"left-side"],["alt","Channel pfp",3,"src"],[1,"center"],[1,"video-title"],[1,"channel-title"],[1,"video-more-info"],[1,"video-views"],[1,"video-date"],[1,"video-img"],[3,"src","alt"],[1,"video-preview"],["width","100%","height","100%","frameborder","0","allow","autoplay; encrypted-media; picture-in-picture","allowfullscreen","",3,"src"]],template:function(t,n){if(t&1&&(r(0,"div",0),F("mouseenter",function(){return n.showPreview()})("mouseleave",function(){return n.hidePreview()}),r(1,"div",1),b(2,W,2,6,"div",2)(3,G,2,1,"div",3),a(),r(4,"div",4)(5,"div",5),m(6,"img",6),a(),r(7,"div",7)(8,"div",8),c(9),a(),r(10,"div",9),c(11),a(),r(12,"div",10)(13,"p",11),c(14),a(),r(15,"span"),c(16,"\u2022"),a(),r(17,"p",12),c(18),a()()()()()),t&2){let o,v,p,S,I,C;s(2),l("ngIf",(o=n.finalVideo())==null||o.videoDetails==null||o.videoDetails.snippet==null||o.videoDetails.snippet.thumbnails==null||o.videoDetails.snippet.thumbnails.maxres==null?null:o.videoDetails.snippet.thumbnails.maxres.url),s(),l("ngIf",n.iframeSrc()),s(3),l("src",(v=n.finalVideo())==null?null:v.channelProfilePic,w),s(3),f((p=n.finalVideo())==null?null:p.videoDetails.snippet.title),s(2),f((S=n.finalVideo())==null?null:S.videoDetails.snippet.channelTitle),s(3),f(n.formatViews((I=n.finalVideo())==null?null:I.videoDetails.statistics.viewCount)),s(4),f(n.timeAgo((C=n.finalVideo())==null?null:C.videoDetails.snippet.publishedAt))}},dependencies:[P],encapsulation:2})};function B(i,e){if(i&1&&m(0,"app-video-card",2),i&2){let t=e.$implicit;l("video",t)}}var y=class i{constructor(e){this.youtubeService=e;$(()=>{console.log(this.videos())})}videos=d([]);ngOnInit(){let e={part:"snippet,statistics,contentDetails",chart:"mostPopular",regionCode:"EG",maxResults:10};this.youtubeService.getVideos(e).subscribe(t=>this.videos.set(t.items))}static \u0275fac=function(t){return new(t||i)(g(u))};static \u0275cmp=h({type:i,selectors:[["app-home"]],decls:2,vars:1,consts:[[1,"app-container"],[3,"video",4,"ngFor","ngForOf"],[3,"video"]],template:function(t,n){t&1&&(r(0,"div",0),b(1,B,1,1,"app-video-card",1),a()),t&2&&(s(),l("ngForOf",n.videos()))},dependencies:[V,N],encapsulation:2})};var ge=[{path:"",component:y}];export{ge as HOME_ROUTES};
